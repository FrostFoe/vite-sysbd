import{a as e,d as t,r as n,v as r}from"./vendor-react-DDJd_2jx.js";import{E as i,U as a,u as o}from"./vendor-ui-dKvDeG77.js";import"./vendor-utils-DddD4xHt.js";import{_ as s,a as c,d as l,f as u,g as d,h as f,i as p,m,n as h,o as g,p as _}from"./index-CIPjBYgy.js";var v=r();const y=(e,t={})=>{let{onSuccess:n,onError:r,autoFetch:i=!0,showErrorToast:a=!0,showSuccessToast:o=!1,successMessage:c}=t,{language:l}=s(),{success:u,error:f}=p(),[m,h]=(0,v.useState)(null),[g,_]=(0,v.useState)(!0),[y,b]=(0,v.useState)(null),x=(0,v.useCallback)(async()=>{_(!0),b(null);try{let t=await e();if(t.success)h(t),n?.(t),o&&c&&u(c);else{let e=t.error||d(`something_went_wrong`,l);b(e),r?.(e),a&&f(e)}}catch{let e=d(`server_error`,l);b(e),r?.(e),a&&f(e)}finally{_(!1)}},[e,l,n,r,a,o,c,u,f]);return(0,v.useEffect)(()=>{i&&x()},[i,x]),{data:m,isLoading:g,error:y,refetch:x}};var b=n(),x=()=>{let{language:n}=s(),r=t(),{data:p,isLoading:x,refetch:S}=y(()=>h.getAllComments(),{onSuccess:e=>{e.comments},showErrorToast:!0}),C=p?.comments||[],w=(0,v.useCallback)(async e=>{if(window.confirm(d(`confirm_delete_comment`,n)))try{let t=await h.deleteComment(e);t.success?(f(d(`comment_deleted`,n)),S()):f(t.error||d(`failed_to_delete_comment`,n),`error`)}catch{f(d(`server_error`,n),`error`)}},[n,S]);return(0,b.jsx)(g,{isLoading:x,children:(0,b.jsxs)(`div`,{className:`space-y-6`,children:[(0,b.jsx)(`div`,{className:`flex justify-between items-center mb-6`,children:(0,b.jsx)(`h1`,{className:`text-2xl font-bold`,children:d(`moderation`,n)})}),(0,b.jsx)(`div`,{className:`bg-card rounded-xl border border-border-color shadow-sm overflow-hidden`,children:(0,b.jsx)(c,{isEmpty:C.length===0,title:`No Comments Found`,description:`There are currently no comments to moderate.`,icon:(0,b.jsx)(i,{className:`w-16 h-16 mx-auto`}),children:(0,b.jsx)(`div`,{className:`grid grid-cols-1 gap-4 p-4`,children:C.map(t=>(0,b.jsxs)(`button`,{onClick:()=>_(window.innerWidth<768,r,`/admin/comments/${t.id}`),type:`button`,className:`bg-card p-4 rounded-lg border border-border-color group hover:bg-muted-bg transition-colors cursor-pointer w-full text-left`,children:[(0,b.jsxs)(`div`,{className:`flex items-start justify-between mb-3`,children:[(0,b.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,b.jsx)(`div`,{className:`w-10 h-10 rounded-full bg-gradient-to-br from-bbcRed to-orange-600 flex items-center justify-center text-white text-sm font-bold`,children:t.user_name.charAt(0).toUpperCase()}),(0,b.jsxs)(`div`,{className:`truncate`,children:[(0,b.jsx)(`div`,{className:`font-bold text-sm truncate`,children:l(t.user_name)}),(0,b.jsx)(`div`,{className:`text-xs text-muted-text truncate`,children:l(n===`bn`?t.title_bn:t.title_en)||`Unknown Article`})]})]}),(0,b.jsxs)(`div`,{className:`flex items-center gap-1 shrink-0 ml-2`,children:[(0,b.jsx)(`div`,{className:`text-xs text-muted-text hidden sm:block whitespace-nowrap`,children:u(t.created_at,n)}),(0,b.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,b.jsx)(e,{to:`/article/${t.article_id}`,target:`_blank`,title:`View Article`,className:`text-muted-text hover:text-bbcRed hover:bg-bbcRed/10 p-2 rounded transition-colors`,children:(0,b.jsx)(a,{className:`w-4 h-4`})}),(0,b.jsx)(`button`,{type:`button`,onClick:()=>w(t.id),className:`text-danger hover:text-danger/80 hover:bg-danger/10 dark:hover:bg-danger/20 p-2 rounded transition-colors`,title:`Delete`,children:(0,b.jsx)(o,{className:`w-4 h-4`})})]})]})]}),(0,b.jsx)(`div`,{className:`text-sm text-card-text max-h-16 overflow-hidden prose prose-sm dark:prose-invert`,children:(()=>{let e=m(t.text),n=document.createElement(`div`);n.innerHTML=e;let r=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){let t=e,n={};for(let e=0;e<t.attributes.length;e++){let r=t.attributes[e],i=r.name===`class`?`className`:r.name;n[i]=r.value}let i=Array.from(t.childNodes).map(r);return(0,v.createElement)(t.tagName.toLowerCase(),n,...i)}return null};return Array.from(n.childNodes).map((e,t)=>r(e))})()}),(0,b.jsx)(`div`,{className:`text-xs text-muted-text mt-2 sm:hidden`,children:u(t.created_at,n)})]},t.id))})})})]})})};export{x as default};