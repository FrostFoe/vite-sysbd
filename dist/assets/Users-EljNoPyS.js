import{r as e}from"./rolldown-runtime-Ckerh37x.js";import{l as t,t as n,v as r}from"./vendor-react-BMISKrB3.js";import{P as i,b as a,h as o,it as s,n as c,u as l}from"./vendor-ui-BHAUFdXB.js";import{f as u,m as d,o as f}from"./index-CN89veYp.js";var p=e(r(),1),m=e(n(),1);const h=({isOpen:e,user:t,onClose:n,onSuccess:r})=>{let[a,o]=(0,p.useState)({email:``,role:`user`,password:``}),[s,l]=(0,p.useState)(!1),[u,h]=(0,p.useState)(``);(0,p.useEffect)(()=>{o(t||{email:``,role:`user`,password:``}),h(``)},[t]);let g=()=>a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?!t&&!a.password?(h(`নতুন ব্যবহারকারীর জন্য পাসওয়ার্ড প্রয়োজন`),!1):!t&&a.password&&a.password.length<6?(h(`পাসওয়ার্ড কমপক্ষে 6 অক্ষর হওয়া উচিত`),!1):!0:(h(`বৈধ ইমেল প্রবেश করুন`),!1):(h(`ইমেল প্রয়োজন`),!1);return e?(0,m.jsx)(`div`,{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm`,children:(0,m.jsxs)(`div`,{className:`bg-card rounded-2xl shadow-2xl border border-border-color w-full max-w-md mx-4 animate-in zoom-in-95`,children:[(0,m.jsxs)(`div`,{className:`flex items-center justify-between p-4 sm:p-6 border-b border-border-color`,children:[(0,m.jsx)(`h2`,{className:`text-lg font-bold`,children:t?.id?`ব্যবহারকারী সম্পাদনা করুন`:`নতুন ব্যবহারকারী তৈরি করুন`}),(0,m.jsx)(`button`,{type:`button`,onClick:n,className:`p-2 hover:bg-muted-bg rounded-lg transition-colors`,children:(0,m.jsx)(c,{className:`w-5 h-5`})})]}),(0,m.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),g()){l(!0);try{if(t?.id){let e=await f.updateUser(t.id,{email:a.email,role:a.role,password:a.password||void 0});e.success?(d(`ব্যবহারকারী সফলভাবে আপডেট হয়েছে`),r(),n()):h(e.error||`ব্যবহারকারী আপডেট করতে ব্যর্থ`)}else{let e=await f.createUser({email:a.email,password:a.password||``,role:a.role});e.success?(d(`ব্যবহারকারী সফলভাবে তৈরি হয়েছে`),r(),n()):h(e.error||`ব্যবহারকারী তৈরি করতে ব্যর্থ`)}}catch{h(`সার্ভার ত্রুটি`)}finally{l(!1)}}},className:`p-4 sm:p-6 space-y-4`,children:[u&&(0,m.jsx)(`div`,{className:`p-3 bg-danger/10 border border-danger/30 rounded-lg text-danger text-sm`,children:u}),(0,m.jsxs)(`div`,{children:[(0,m.jsx)(`label`,{htmlFor:`email`,className:`block text-sm font-bold mb-2`,children:`ইমেল`}),(0,m.jsx)(`input`,{id:`email`,type:`email`,value:a.email,onChange:e=>{o(t=>({...t,email:e.target.value})),h(``)},className:`w-full px-4 py-2 rounded-lg border border-border-color bg-muted-bg text-card-text focus:ring-2 focus:ring-bbcRed/20 focus:border-bbcRed outline-none transition-all`,placeholder:`user@example.com`})]}),(0,m.jsxs)(`div`,{children:[(0,m.jsx)(`label`,{htmlFor:`role`,className:`block text-sm font-bold mb-2`,children:`ভূমিকা`}),(0,m.jsxs)(`select`,{id:`role`,value:a.role,onChange:e=>o(t=>({...t,role:e.target.value})),className:`w-full px-4 py-2 rounded-lg border border-border-color bg-muted-bg text-card-text focus:ring-2 focus:ring-bbcRed/20 focus:border-bbcRed outline-none transition-all`,children:[(0,m.jsx)(`option`,{value:`user`,children:`ব্যবহারকারী`}),(0,m.jsx)(`option`,{value:`admin`,children:`অ্যাডমিন`})]})]}),(!t?.id||a.password)&&(0,m.jsxs)(`div`,{children:[(0,m.jsx)(`label`,{htmlFor:`password`,className:`block text-sm font-bold mb-2`,children:t?.id?`নতুন পাসওয়ার্ড (ঐচ্ছিক)`:`পাসওয়ার্ড`}),(0,m.jsx)(`input`,{id:`password`,type:`password`,value:a.password||``,onChange:e=>{o(t=>({...t,password:e.target.value})),h(``)},className:`w-full px-4 py-2 rounded-lg border border-border-color bg-muted-bg text-card-text focus:ring-2 focus:ring-bbcRed/20 focus:border-bbcRed outline-none transition-all`,placeholder:t?.id?`ছেড়ে যান অপরিবর্তিত`:`পাসওয়ার্ড প্রবেশ করুন`})]}),(0,m.jsxs)(`div`,{className:`flex gap-3 justify-end pt-4`,children:[(0,m.jsx)(`button`,{type:`button`,onClick:n,className:`px-4 py-2 rounded-lg bg-muted-bg hover:bg-border-color text-card-text font-bold transition-colors`,children:`বাতিল`}),(0,m.jsxs)(`button`,{type:`submit`,disabled:s,className:`px-4 py-2 rounded-lg bg-bbcRed hover:bg-bbcRed/90 text-white font-bold transition-colors disabled:opacity-50 flex items-center gap-2`,children:[s&&(0,m.jsx)(i,{className:`w-4 h-4 animate-spin`}),t?.id?`আপডেট করুন`:`তৈরি করুন`]})]})]})]})}):null};var g=()=>{let e=t(),[n,r]=(0,p.useState)([]),[c,g]=(0,p.useState)(!0),[_,v]=(0,p.useState)(!1),[y,b]=(0,p.useState)(null),x=(0,p.useCallback)(async()=>{g(!0);try{let e=await f.getUsers();e.success&&e.users?r(e.users):d(e.error||`Failed to fetch users`,`error`)}catch{d(`সার্ভার ত্রুটি!`,`error`)}finally{g(!1)}},[]);(0,p.useEffect)(()=>{x()},[x]);let S=e=>{b(e||null),v(!0)},C=()=>{v(!1),b(null)},w=async(e,t)=>{if(window.confirm(`আপনি কি নিশ্চিত যে আপনি ${t} ব্যবহারকারীকে ডিলিট করতে চান?`))try{let t=await f.deleteUser(e);t.success?(d(`ব্যবহারকারী সফলভাবে ডিলিট হয়েছে`),x()):d(t.error||`ব্যবহারকারী ডিলিট করতে ব্যর্থ`,`error`)}catch{d(`সার্ভার ত্রুটি!`,`error`)}};return c?(0,m.jsx)(`div`,{className:`text-center py-8`,children:(0,m.jsx)(i,{className:`w-10 h-10 animate-spin text-bbcRed`})}):(0,m.jsxs)(`div`,{className:`space-y-4 sm:space-y-6`,children:[(0,m.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,m.jsx)(`h1`,{className:`text-xl sm:text-2xl font-bold`,children:`ব্যবহারকারী`}),(0,m.jsxs)(`button`,{type:`button`,onClick:()=>S(),className:`flex items-center gap-2 px-4 py-2 bg-bbcRed text-white rounded-lg font-bold hover:bg-bbcRed/90 transition-colors`,children:[(0,m.jsx)(a,{className:`w-4 h-4`}),` নতুন ব্যবহারকারী`]})]}),(0,m.jsx)(`div`,{className:`bg-card rounded-xl border border-border-color shadow-sm overflow-hidden`,children:n.length===0?(0,m.jsx)(`div`,{className:`p-6 sm:p-8 text-center text-muted-text text-sm`,children:`কোনো ব্যবহারকারী পাওয়া যায়নি।`}):(0,m.jsx)(`div`,{className:`grid grid-cols-1 gap-3 sm:gap-4 p-3 sm:p-4`,children:n.map(t=>(0,m.jsx)(`button`,{onClick:()=>u(window.innerWidth<768,e,`/admin/users/${t.id}`),type:`button`,className:`bg-card p-3 sm:p-4 rounded-lg border border-border-color group hover:bg-muted-bg transition-colors cursor-pointer w-full text-left`,children:(0,m.jsxs)(`div`,{className:`flex items-start justify-between gap-2`,children:[(0,m.jsxs)(`div`,{className:`flex items-center gap-2 sm:gap-3 min-w-0`,children:[(0,m.jsx)(`div`,{className:`w-10 sm:w-12 h-10 sm:h-12 rounded-full bg-gradient-to-br from-bbcRed to-orange-600 flex items-center justify-center text-white text-xs sm:text-sm font-bold flex-shrink-0`,children:t.email.charAt(0).toUpperCase()}),(0,m.jsxs)(`div`,{className:`truncate`,children:[(0,m.jsx)(`div`,{className:`font-bold text-xs sm:text-sm truncate`,children:t.email}),(0,m.jsxs)(`div`,{className:`text-[10px] sm:text-xs text-muted-text truncate`,children:[`ID: `,t.id]}),(0,m.jsx)(`div`,{className:`mt-1 text-[10px] sm:text-xs font-bold`,children:(0,m.jsxs)(`span`,{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-success/10 dark:bg-success/20 text-success whitespace-nowrap`,children:[(0,m.jsx)(s,{className:`w-3 h-3`}),` সক্রিয়`]})})]})]}),(0,m.jsxs)(`div`,{className:`flex items-center gap-1 flex-shrink-0`,children:[(0,m.jsx)(`div`,{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${t.role===`admin`?`bg-danger/10 dark:bg-danger/20 text-danger`:`bg-muted-bg text-card-text`}`,children:t.role}),(0,m.jsx)(`div`,{className:`text-xs text-muted-text hidden sm:block`,children:new Date(t.created_at).toLocaleDateString()}),(0,m.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,m.jsx)(`button`,{type:`button`,onClick:e=>{e.stopPropagation(),S(t)},className:`text-muted-text hover:text-card-text hover:bg-muted-bg p-2 rounded transition-colors`,title:`সম্পাদনা`,children:(0,m.jsx)(o,{className:`w-4 h-4`})}),(0,m.jsx)(`button`,{type:`button`,onClick:e=>{e.stopPropagation(),w(t.id,t.email)},className:`text-danger hover:text-danger/80 hover:bg-danger/10 dark:hover:bg-danger/20 p-2 rounded transition-colors`,title:`ডিলিট`,children:(0,m.jsx)(l,{className:`w-4 h-4`})})]})]})]})},t.id))})}),(0,m.jsx)(h,{isOpen:_,user:y,onClose:C,onSuccess:x})]})};export{g as default};