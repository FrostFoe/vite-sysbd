import{r as e}from"./rolldown-runtime-Ckerh37x.js";import{m as t,p as n,r,t as i,u as a,v as o}from"./vendor-react-BMISKrB3.js";import{t as s}from"./vendor-ZnNI0bLa.js";import{$ as c,F as l,J as u,O as d,P as f,S as p,T as m,X as h,Z as g,c as ee,d as _,dt as v,et as y,f as b,ft as x,h as S,i as C,j as w,k as T,n as E,p as D,r as O,rt as k,s as A,ut as j,v as M,w as N,y as P}from"./vendor-ui-D8qgxIws.js";import{_ as F,c as I,d as L,g as R,i as z,m as B,o as V,p as H,s as U,t as W,u as G}from"./index-BWjc1K1x.js";var K=n(),q=e(o(),1),J=e(i(),1),Y=e=>{let t=(0,K.c)(45),{src:n,alt:r,title:i,className:a,width:o,height:s,caption:c,showCaption:l}=e,u=r===void 0?``:r,d=a===void 0?``:a,f=l===void 0?!0:l,[p,m]=(0,q.useState)(!0),[ee,_]=(0,q.useState)(!1),[v,y]=(0,q.useState)(!0),b;t[0]===n?b=t[1]:(b=H(n),t[0]=n,t[1]=b);let x=b,S;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(S=()=>{m(!1)},t[2]=S):S=t[2];let C=S,w;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(w=()=>{m(!1),_(!0)},t[3]=w):w=t[3];let T=w,E;t[4]===v?E=t[5]:(E=()=>{y(!v)},t[4]=v,t[5]=E);let D=E;if(!v){let e=`relative w-full bg-muted-bg border border-border-color rounded-lg flex items-center justify-center cursor-pointer ${d}`,n;t[6]===D?n=t[7]:(n=e=>{(e.key===`Enter`||e.key===` `)&&D()},t[6]=D,t[7]=n);let r=v?`Hide image`:`Show image`,i;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,J.jsxs)(`div`,{className:`text-center p-4`,children:[(0,J.jsx)(g,{className:`w-8 h-8 mx-auto text-muted-text`}),(0,J.jsx)(`p`,{className:`mt-2 text-sm text-muted-text`,children:`Image hidden`}),(0,J.jsx)(`p`,{className:`text-xs text-muted-text`,children:`Click to show`})]}),t[8]=i):i=t[8];let a;return t[9]!==r||t[10]!==e||t[11]!==n||t[12]!==D?(a=(0,J.jsx)(`button`,{type:`button`,className:e,onClick:D,onKeyDown:n,"aria-label":r,children:i}),t[9]=r,t[10]=e,t[11]=n,t[12]=D,t[13]=a):a=t[13],a}if(ee){let e=`relative w-full bg-muted-bg border border-border-color rounded-lg flex items-center justify-center ${d}`,n,r;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,J.jsx)(`div`,{className:`bg-muted-bg border-2 border-dashed border-border-color rounded-xl w-16 h-16 mx-auto`}),n=(0,J.jsx)(`p`,{className:`mt-2 text-sm text-muted-text`,children:`Image failed to load`}),t[14]=n,t[15]=r):(n=t[14],r=t[15]);let i;t[16]===x?i=t[17]:(i=(0,J.jsxs)(`div`,{className:`text-center p-4`,children:[r,n,(0,J.jsx)(`p`,{className:`text-xs text-muted-text`,children:x})]}),t[16]=x,t[17]=i);let a;return t[18]!==i||t[19]!==e?(a=(0,J.jsx)(`div`,{className:e,children:i}),t[18]=i,t[19]=e,t[20]=a):a=t[20],a}let O=`relative ${d}`,k;t[21]===p?k=t[22]:(k=p&&(0,J.jsx)(`div`,{className:`absolute inset-0 bg-muted-bg animate-pulse rounded-lg flex items-center justify-center`,children:(0,J.jsx)(`span`,{className:`text-sm text-muted-text`,children:`Loading...`})}),t[21]=p,t[22]=k);let A=`w-full h-auto rounded-lg ${p?`opacity-0`:`opacity-100`} transition-opacity duration-300`,j;t[23]!==u||t[24]!==s||t[25]!==x||t[26]!==A||t[27]!==i||t[28]!==o?(j=(0,J.jsx)(`img`,{src:x,alt:u,title:i,width:o,height:s,crossOrigin:`anonymous`,onLoad:C,onError:T,className:A}),t[23]=u,t[24]=s,t[25]=x,t[26]=A,t[27]=i,t[28]=o,t[29]=j):j=t[29];let M;t[30]!==c||t[31]!==f?(M=f&&c&&(0,J.jsx)(`figcaption`,{className:`mt-2 text-sm text-center text-muted-text italic`,children:c}),t[30]=c,t[31]=f,t[32]=M):M=t[32];let N=v?`Hide image`:`Show image`,P;t[33]===v?P=t[34]:(P=v?(0,J.jsx)(g,{className:`w-4 h-4`}):(0,J.jsx)(h,{className:`w-4 h-4`}),t[33]=v,t[34]=P);let F;t[35]!==N||t[36]!==P||t[37]!==D?(F=(0,J.jsx)(`button`,{type:`button`,onClick:D,className:`absolute top-2 right-2 p-1.5 bg-black/50 hover:bg-black/70 text-white rounded-full transition-all opacity-0 hover:opacity-100 group-hover:opacity-100`,"aria-label":N,children:P}),t[35]=N,t[36]=P,t[37]=D,t[38]=F):F=t[38];let I;return t[39]!==j||t[40]!==M||t[41]!==F||t[42]!==O||t[43]!==k?(I=(0,J.jsxs)(`figure`,{className:O,children:[k,j,M,F]}),t[39]=j,t[40]=M,t[41]=F,t[42]=O,t[43]=k,t[44]=I):I=t[44],I},te=n(),X=e=>{let t=(0,te.c)(56),{src:n,alt:r,title:i,className:a,width:o,height:s,poster:c,caption:l,showCaption:u,loop:d,muted:f,controls:m}=e,h=r===void 0?``:r,g=a===void 0?``:a,ee=o===void 0?`100%`:o,_=s===void 0?`auto`:s,v=u===void 0?!0:u,y=d===void 0?!1:d,b=f===void 0?!1:f,x=m===void 0?!0:m,[S,T]=(0,q.useState)(!1),[E,D]=(0,q.useState)(b),[k,A]=(0,q.useState)(!0),[j,M]=(0,q.useState)(!1),P=(0,q.useRef)(null),F;t[0]===n?F=t[1]:(F=H(n),t[0]=n,t[1]=F);let I=F,L;t[2]===c?L=t[3]:(L=H(c),t[2]=c,t[3]=L);let R=L,z;t[4]===S?z=t[5]:(z=()=>{P.current&&(S?(P.current.pause(),T(!1)):(P.current.play(),T(!0)))},t[4]=S,t[5]=z);let B=z,V;t[6]===E?V=t[7]:(V=()=>{P.current&&(P.current.muted=!E,D(!E))},t[6]=E,t[7]=V);let U=V,W;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(W=()=>{A(!0)},t[8]=W):W=t[8];let G=W,K;t[9]===Symbol.for(`react.memo_cache_sentinel`)?(K=()=>{A(!1)},t[9]=K):K=t[9];let Y=K,X;t[10]===Symbol.for(`react.memo_cache_sentinel`)?(X=()=>{A(!1),M(!0)},t[10]=X):X=t[10];let ne=X,Z;t[11]===y?Z=t[12]:(Z=()=>{P.current&&P.current.currentTime>=P.current.duration-.1&&!y&&T(!1)},t[11]=y,t[12]=Z);let re=Z,Q;t[13]===y?Q=t[14]:(Q=()=>{y||T(!1)},t[13]=y,t[14]=Q);let ie=Q;if(j){let e=`relative w-full bg-muted-bg border border-border-color rounded-lg flex flex-col items-center justify-center ${g}`,n,r;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,J.jsx)(`div`,{className:`bg-muted-bg border-2 border-dashed border-border-color rounded-xl w-16 h-16 mx-auto flex items-center justify-center`,children:(0,J.jsx)(p,{className:`w-6 h-6 text-muted-text`})}),r=(0,J.jsx)(`p`,{className:`mt-2 text-sm text-muted-text`,children:`Video failed to load`}),t[15]=n,t[16]=r):(n=t[15],r=t[16]);let i;t[17]===I?i=t[18]:(i=(0,J.jsxs)(`div`,{className:`p-4 text-center`,children:[n,r,(0,J.jsx)(`p`,{className:`text-xs text-muted-text`,children:I})]}),t[17]=I,t[18]=i);let a;return t[19]!==e||t[20]!==i?(a=(0,J.jsx)(`div`,{className:e,children:i}),t[19]=e,t[20]=i,t[21]=a):a=t[21],a}let ae=`relative ${g}`,oe;t[22]===k?oe=t[23]:(oe=k&&(0,J.jsx)(`div`,{className:`absolute inset-0 bg-card flex items-center justify-center`,children:(0,J.jsx)(`div`,{className:`animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-white`})}),t[22]=k,t[23]=oe);let se=`w-full h-auto ${k?`opacity-0`:`opacity-100`} transition-opacity duration-300`,$,ce;t[24]===Symbol.for(`react.memo_cache_sentinel`)?($=()=>T(!0),ce=()=>T(!1),t[24]=$,t[25]=ce):($=t[24],ce=t[25]);let le=h||`Video content`,ue;t[26]!==x||t[27]!==re||t[28]!==ie||t[29]!==_||t[30]!==E||t[31]!==y||t[32]!==R||t[33]!==I||t[34]!==se||t[35]!==le||t[36]!==i||t[37]!==ee?(ue=(0,J.jsx)(`video`,{ref:P,src:I,poster:R,loop:y,muted:E,controls:x,width:ee,height:_,title:i,crossOrigin:`anonymous`,className:se,onPlay:$,onPause:ce,onEnded:ie,onTimeUpdate:re,onLoadStart:G,onCanPlay:Y,onError:ne,"aria-label":le}),t[26]=x,t[27]=re,t[28]=ie,t[29]=_,t[30]=E,t[31]=y,t[32]=R,t[33]=I,t[34]=se,t[35]=le,t[36]=i,t[37]=ee,t[38]=ue):ue=t[38];let de;t[39]!==x||t[40]!==U||t[41]!==B||t[42]!==E||t[43]!==S?(de=!x&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity`,children:(0,J.jsx)(`button`,{type:`button`,onClick:B,className:`bg-black/50 hover:bg-black/70 text-white p-4 rounded-full transition-all`,"aria-label":S?`Pause video`:`Play video`,children:S?(0,J.jsx)(N,{className:`w-8 h-8`}):(0,J.jsx)(p,{className:`w-8 h-8`})})}),(0,J.jsxs)(`div`,{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 opacity-0 hover:opacity-100 transition-opacity flex justify-between items-center`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:U,className:`text-white hover:text-white/80`,"aria-label":E?`Unmute video`:`Mute video`,children:E?(0,J.jsx)(O,{className:`w-5 h-5`}):(0,J.jsx)(C,{className:`w-5 h-5`})}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>{P.current&&P.current.requestFullscreen?.()},className:`text-white hover:text-white/80`,"aria-label":`Enter fullscreen`,children:(0,J.jsx)(w,{className:`w-5 h-5`})})]})]}),t[39]=x,t[40]=U,t[41]=B,t[42]=E,t[43]=S,t[44]=de):de=t[44];let fe;t[45]!==oe||t[46]!==ue||t[47]!==de?(fe=(0,J.jsxs)(`div`,{className:`relative bg-black rounded-lg overflow-hidden`,children:[oe,ue,de]}),t[45]=oe,t[46]=ue,t[47]=de,t[48]=fe):fe=t[48];let pe;t[49]!==l||t[50]!==v?(pe=v&&l&&(0,J.jsx)(`figcaption`,{className:`mt-2 text-sm text-center text-muted-text italic`,children:l}),t[49]=l,t[50]=v,t[51]=pe):pe=t[51];let me;return t[52]!==ae||t[53]!==fe||t[54]!==pe?(me=(0,J.jsxs)(`figure`,{className:ae,children:[fe,pe]}),t[52]=ae,t[53]=fe,t[54]=pe,t[55]=me):me=t[55],me},ne=n(),Z=e=>{let t=(0,ne.c)(61),{onHighlight:n,onCopy:r,onSelectAll:i,onSearch:a,onAskAI:o,onAddComment:s,onClose:c,visible:l,position:u}=e,[f,p]=(0,q.useState)(!1),h=(0,q.useRef)(null),g,_;t[0]!==c||t[1]!==l?(g=()=>{let e=e=>{l&&(h.current?.contains(e.target)||(p(!1),c()))};return l&&document.addEventListener(`mousedown`,e),()=>{document.removeEventListener(`mousedown`,e)}},_=[l,c],t[0]=c,t[1]=l,t[2]=g,t[3]=_):(g=t[2],_=t[3]),(0,q.useEffect)(g,_);let v;t[4]===Symbol.for(`react.memo_cache_sentinel`)?(v=[{name:`Yellow`,value:`bg-yellow-200`,displayColor:`bg-yellow-400`},{name:`Green`,value:`bg-green-200`,displayColor:`bg-green-400`},{name:`Blue`,value:`bg-blue-200`,displayColor:`bg-blue-400`},{name:`Pink`,value:`bg-pink-200`,displayColor:`bg-pink-400`},{name:`Purple`,value:`bg-purple-200`,displayColor:`bg-purple-400`}],t[4]=v):v=t[4];let b=v;if(!l)return null;let x=Math.max(10,u.top-50),C;t[5]!==x||t[6]!==u.left?(C={top:x,left:u.left,transform:`translateX(-50%)`},t[5]=x,t[6]=u.left,t[7]=C):C=t[7];let w;t[8]===r?w=t[9]:(w=e=>{e.stopPropagation(),r()},t[8]=r,t[9]=w);let T;t[10]===Symbol.for(`react.memo_cache_sentinel`)?(T=(0,J.jsx)(y,{className:`w-4 h-4`}),t[10]=T):T=t[10];let E;t[11]===w?E=t[12]:(E=(0,J.jsx)(`button`,{type:`button`,onClick:w,className:`p-2 rounded-md hover:bg-muted-bg transition-colors`,title:`Copy text`,children:T}),t[11]=w,t[12]=E);let D;t[13]===a?D=t[14]:(D=e=>{e.stopPropagation(),a()},t[13]=a,t[14]=D);let O;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(O=(0,J.jsx)(P,{className:`w-4 h-4`}),t[15]=O):O=t[15];let k;t[16]===D?k=t[17]:(k=(0,J.jsx)(`button`,{type:`button`,onClick:D,className:`p-2 rounded-md hover:bg-muted-bg transition-colors`,title:`Search Web`,children:O}),t[16]=D,t[17]=k);let A;t[18]===o?A=t[19]:(A=e=>{e.stopPropagation(),o()},t[18]=o,t[19]=A);let M;t[20]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,J.jsx)(j,{className:`w-4 h-4`}),t[20]=M):M=t[20];let N;t[21]===A?N=t[22]:(N=(0,J.jsx)(`button`,{type:`button`,onClick:A,className:`p-2 rounded-md hover:bg-muted-bg transition-colors`,title:`Ask AI`,children:M}),t[21]=A,t[22]=N);let F;t[23]===s?F=t[24]:(F=e=>{e.stopPropagation(),s()},t[23]=s,t[24]=F);let I;t[25]===Symbol.for(`react.memo_cache_sentinel`)?(I=(0,J.jsx)(d,{className:`w-4 h-4`}),t[25]=I):I=t[25];let L;t[26]===F?L=t[27]:(L=(0,J.jsx)(`button`,{type:`button`,onClick:F,className:`p-2 rounded-md hover:bg-muted-bg transition-colors`,title:`Quote Reply`,children:I}),t[26]=F,t[27]=L);let R;t[28]===Symbol.for(`react.memo_cache_sentinel`)?(R=(0,J.jsx)(`div`,{className:`w-px h-4 bg-border-color mx-1`}),t[28]=R):R=t[28];let z;t[29]===i?z=t[30]:(z=e=>{e.stopPropagation(),i()},t[29]=i,t[30]=z);let B;t[31]===Symbol.for(`react.memo_cache_sentinel`)?(B=(0,J.jsx)(S,{className:`w-4 h-4`}),t[31]=B):B=t[31];let V;t[32]===z?V=t[33]:(V=(0,J.jsx)(`button`,{type:`button`,onClick:z,className:`p-2 rounded-md hover:bg-muted-bg transition-colors`,title:`Select all`,children:B}),t[32]=z,t[33]=V);let H;t[34]===f?H=t[35]:(H=e=>{e.stopPropagation(),p(!f)},t[34]=f,t[35]=H);let U=`p-2 rounded-md hover:bg-muted-bg transition-colors flex items-center gap-1 ${f?`bg-muted-bg`:``}`,W;t[36]===Symbol.for(`react.memo_cache_sentinel`)?(W=(0,J.jsx)(m,{className:`w-4 h-4`}),t[36]=W):W=t[36];let G;t[37]!==H||t[38]!==U?(G=(0,J.jsx)(`button`,{type:`button`,onClick:H,className:U,title:`Highlight text`,children:W}),t[37]=H,t[38]=U,t[39]=G):G=t[39];let K;t[40]!==n||t[41]!==f?(K=f&&(0,J.jsx)(`div`,{className:`absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-card border border-border-color rounded-lg shadow-xl p-2 flex flex-wrap gap-2 w-32 z-20`,children:b.map(e=>(0,J.jsx)(`button`,{type:`button`,onClick:t=>{t.stopPropagation(),n(e.value),p(!1)},className:`w-6 h-6 rounded-full ${e.displayColor} hover:scale-110 transition-transform ring-1 ring-border-color`,title:`Highlight with ${e.name}`},e.name))}),t[40]=n,t[41]=f,t[42]=K):K=t[42];let Y;t[43]!==G||t[44]!==K?(Y=(0,J.jsxs)(`div`,{className:`relative`,children:[G,K]}),t[43]=G,t[44]=K,t[45]=Y):Y=t[45];let te;t[46]===Symbol.for(`react.memo_cache_sentinel`)?(te=(0,J.jsx)(`div`,{className:`w-px h-4 bg-border-color mx-1`}),t[46]=te):te=t[46];let X;t[47]===c?X=t[48]:(X=e=>{e.stopPropagation(),c()},t[47]=c,t[48]=X);let Z;t[49]===Symbol.for(`react.memo_cache_sentinel`)?(Z=(0,J.jsx)(ee,{className:`w-4 h-4`}),t[49]=Z):Z=t[49];let Q;t[50]===X?Q=t[51]:(Q=(0,J.jsx)(`button`,{type:`button`,onClick:X,className:`p-1 rounded-md hover:bg-red-100 hover:text-red-600 transition-colors ml-1`,title:`Close toolbar`,children:Z}),t[50]=X,t[51]=Q);let ie;return t[52]!==k||t[53]!==N||t[54]!==L||t[55]!==V||t[56]!==Y||t[57]!==Q||t[58]!==C||t[59]!==E?(ie=(0,J.jsxs)(`div`,{ref:h,role:`toolbar`,className:`absolute z-[1000] flex items-center gap-1 bg-card text-card-text shadow-xl rounded-lg p-2 border border-border-color animate-in fade-in zoom-in-95 duration-200 max-w-[95vw] overflow-x-auto`,style:C,onMouseDown:re,children:[E,k,N,L,R,V,Y,te,Q]}),t[52]=k,t[53]=N,t[54]=L,t[55]=V,t[56]=Y,t[57]=Q,t[58]=C,t[59]=E,t[60]=ie):ie=t[60],ie};function re(e){return e.stopPropagation()}var Q=n(),ie=e=>{let t=(0,Q.c)(39),{content:n,className:r,fontSizeClass:i,containerRef:a,enableTextSelectionToolbar:o,onTextSelected:c,onAddComment:l}=e,u=r===void 0?``:r,d=i===void 0?``:i,f=o===void 0?!1:o,[p,m]=(0,q.useState)(!1),h;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(h={top:0,left:0},t[0]=h):h=t[0];let[g,ee]=(0,q.useState)(h),[_,v]=(0,q.useState)(``),y=n,b;if(t[1]!==y){let e=[];y=y.replace(/<img\s+([^>]*?)\s*>/gi,(t,n)=>{let r=n.match(/src\s*=\s*["']([^"']*)["']/i),i=n.match(/alt\s*=\s*["']([^"']*)["']/i),a=n.match(/title\s*=\s*["']([^"']*)["']/i),o=n.match(/width\s*=\s*["']([^"']*)["']/i),s=n.match(/height\s*=\s*["']([^"']*)["']/i),c=e.length;return e.push((0,J.jsx)(Y,{src:r?r[1]:``,alt:i?i[1]:``,title:a?a[1]:``,width:o?o[1]:void 0,height:s?s[1]:void 0,className:`my-4`},`img-${c}`)),`__CUSTOM_COMPONENT_PLACEHOLDER_${c}__`}),y=y.replace(/<video\s+([^>]*?)\s*\/?>.*?<\/video>|<video\s+([^>]*?)\s*>/gi,t=>{let n=t.match(/src\s*=\s*["']([^"']*)["']/i),r=t.match(/poster\s*=\s*["']([^"']*)["']/i),i=t.match(/alt\s*=\s*["']([^"']*)["']/i),a=t.match(/title\s*=\s*["']([^"']*)["']/i),o=t.match(/width\s*=\s*["']([^"']*)["']/i),s=t.match(/height\s*=\s*["']([^"']*)["']/i),c=t.includes(`loop`),l=t.includes(`muted`),u=t.includes(`controls`),d=e.length;return e.push((0,J.jsx)(X,{src:n?n[1]:``,poster:r?r[1]:``,alt:i?i[1]:``,title:a?a[1]:``,width:o?o[1]:void 0,height:s?s[1]:void 0,loop:c,muted:l,controls:u,className:`my-4`},`video-${d}`)),`__CUSTOM_COMPONENT_PLACEHOLDER_${d}__`});let n=y.split(/(__CUSTOM_COMPONENT_PLACEHOLDER_\d+__)/),r=(e,t)=>{if(e.nodeType===Node.TEXT_NODE){let t=e.textContent;return t?.trim()?t:null}if(e.nodeType===Node.ELEMENT_NODE){let n=e,i={key:t};for(let e=0;e<n.attributes.length;e++){let t=n.attributes[e],r=t.name===`class`?`className`:t.name;i[r]=t.value}let a=Array.from(n.childNodes).map((e,n)=>r(e,`${t}-child-${n}`)).filter(ae);return(0,q.createElement)(n.tagName.toLowerCase(),i,...a)}return null};b=n.map((t,n)=>{if(t.startsWith(`__CUSTOM_COMPONENT_PLACEHOLDER_`)){let n=t.match(/__CUSTOM_COMPONENT_PLACEHOLDER_(\d+)__/);if(n)return e[parseInt(n[1],10)]}else if(t.trim()){let e=s.sanitize(t),i=document.createElement(`div`);return i.innerHTML=e,Array.from(i.childNodes).map((e,t)=>r(e,`part-${n}-node-${t}`)).filter(oe)}return null}).filter(Boolean).flat(),t[1]=y,t[2]=b,t[3]=y}else b=t[2],y=t[3];let x=b,S,C;t[4]!==a||t[5]!==f||t[6]!==c?(S=()=>{if(!f)return;let e=()=>{let e=window.getSelection();if(!e||e.toString().trim()===``){m(!1),v(``);return}let t=e.toString().trim();if(!t){m(!1);return}let n=e.getRangeAt(0),r=a?.current;if(!r||!r.contains(n.commonAncestorContainer)){m(!1);return}let i=document.createRange();i.setStart(n.endContainer,n.endOffset),i.collapse(!0);let o=i.getBoundingClientRect(),s=r.getBoundingClientRect(),l=o.top-s.top-50,u=o.left-s.left+o.width/2;u=Math.max(160,Math.min(u,s.width-160)),s.width<320&&(u=s.width/2),ee({top:l,left:u}),v(t),m(!0),c&&c(t)},t=()=>{setTimeout(e,0)};return document.addEventListener(`mouseup`,t),document.addEventListener(`selectionchange`,e),()=>{document.removeEventListener(`mouseup`,t),document.removeEventListener(`selectionchange`,e)}},C=[f,a,c],t[4]=a,t[5]=f,t[6]=c,t[7]=S,t[8]=C):(S=t[7],C=t[8]),(0,q.useEffect)(S,C);let w;t[9]===_?w=t[10]:(w=()=>{_&&navigator.clipboard.writeText(_).then(()=>{B(`Text copied to clipboard`),m(!1)}).catch(()=>{let e=document.createElement(`textarea`);e.value=_,document.body.appendChild(e),e.select(),document.execCommand(`copy`),document.body.removeChild(e),B(`Text copied to clipboard`),m(!1)})},t[9]=_,t[10]=w);let T=w,E;t[11]===_?E=t[12]:(E=()=>{_&&(window.open(`https://www.google.com/search?q=${encodeURIComponent(_)}`,`_blank`),m(!1))},t[11]=_,t[12]=E);let D=E,O;t[13]===_?O=t[14]:(O=()=>{_&&(navigator.clipboard.writeText(_).catch(se),window.open(`https://chat.openai.com`,`_blank`),B(`Text copied! Paste it in ChatGPT.`),m(!1))},t[13]=_,t[14]=O);let k=O,A;t[15]!==l||t[16]!==_?(A=()=>{_&&l&&(l(_),m(!1))},t[15]=l,t[16]=_,t[17]=A):A=t[17];let j=A,M;t[18]===a?M=t[19]:(M=()=>{let e=a?.current;if(e){let t=window.getSelection();if(t){let n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}},t[18]=a,t[19]=M);let N=M,P;t[20]===Symbol.for(`react.memo_cache_sentinel`)?(P=e=>{let t=window.getSelection();if(!t||t.toString().trim()===``)return;let n=t.getRangeAt(0),r=document.createElement(`span`);r.className=`${e} rounded-sm transition-colors duration-200`,n.surroundContents(r),t.removeAllRanges(),m(!1)},t[20]=P):P=t[20];let F=P,I;t[21]===a?I=t[22]:(I=e=>{let t=window.getSelection();if(t&&t.toString().trim()!==``){e.preventDefault();let n=t.toString().trim();if(n&&a?.current){let e=t.getRangeAt(0);if(a.current.contains(e.commonAncestorContainer)){let t=document.createRange();t.setStart(e.endContainer,e.endOffset),t.collapse(!0);let r=t.getBoundingClientRect(),i=a.current.getBoundingClientRect(),o=r.top-i.top-50,s=r.left-i.left+r.width/2;s=Math.max(160,Math.min(s,i.width-160)),i.width<320&&(s=i.width/2),ee({top:o,left:s}),v(n),m(!0)}}}},t[21]=a,t[22]=I);let L=I,R=`relative prose max-w-none ${d} ${u} transition-all duration-300 ease-in-out`,z;t[23]===Symbol.for(`react.memo_cache_sentinel`)?(z={fontSize:`inherit`},t[23]=z):z=t[23];let V=f&&p,H;t[24]===Symbol.for(`react.memo_cache_sentinel`)?(H=()=>m(!1),t[24]=H):H=t[24];let U;t[25]!==j||t[26]!==k||t[27]!==T||t[28]!==D||t[29]!==N||t[30]!==V||t[31]!==g?(U=(0,J.jsx)(Z,{visible:V,position:g,onHighlight:F,onCopy:T,onSelectAll:N,onSearch:D,onAskAI:k,onAddComment:j,onClose:H}),t[25]=j,t[26]=k,t[27]=T,t[28]=D,t[29]=N,t[30]=V,t[31]=g,t[32]=U):U=t[32];let W;return t[33]!==a||t[34]!==L||t[35]!==x||t[36]!==R||t[37]!==U?(W=(0,J.jsxs)(`article`,{ref:a,tabIndex:-1,className:R,style:z,onContextMenu:L,children:[x,U]}),t[33]=a,t[34]=L,t[35]=x,t[36]=R,t[37]=U,t[38]=W):W=t[38],W};function ae(e){return e!=null}function oe(e){return e!==null}function se(){}var $=()=>{let{id:e}=a(),{language:n}=F(),{user:i,isAuthenticated:o}=W(),[d,p]=(0,q.useState)(null),[m,h]=(0,q.useState)([]),[g,ee]=(0,q.useState)(!0),[y,S]=(0,q.useState)([]),[C,w]=(0,q.useState)(`md`),[O,j]=(0,q.useState)(``),[N,P]=(0,q.useState)(``),[G,K]=(0,q.useState)({}),[Y,te]=(0,q.useState)(`newest`),[X,ne]=(0,q.useState)({}),[Z,re]=(0,q.useState)(null),[Q,ae]=(0,q.useState)(!1),[oe,se]=(0,q.useState)(!1),[$,ce]=(0,q.useState)(null),le=(0,q.useRef)(null),ue=i?.role===`admin`;(0,q.useEffect)(()=>{try{let t=localStorage.getItem(`breachtimes-bookmarks`);if(t&&S(JSON.parse(t)),e){let t=localStorage.getItem(`votes-${e}`);t&&K(JSON.parse(t));let n=localStorage.getItem(`sort-${e}`);n&&te(n)}}catch{}},[e]),(0,q.useEffect)(()=>{(async()=>{if(e){ee(!0);try{let t=await U.getArticle(e,n);t.success&&t.article?p(t.article):p(null);let r=await V.getArticles({status:`published`,lang:n});r.success&&r.articles&&h(r.articles)}catch{p(null)}finally{ee(!1)}}})()},[e,n]);let de=(0,q.useCallback)(e=>{w(e)},[]),fe=(0,q.useCallback)(()=>{e&&S(t=>{let r=t.indexOf(e),i=r>-1?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(`breachtimes-bookmarks`,JSON.stringify(i)),B(R(r>-1?`removed`:`saved_successfully`,n)),i})},[e,n]),pe=(0,q.useCallback)(()=>{navigator.share?navigator.share({title:d?.title||document.title,url:window.location.href}).catch(()=>{}):navigator.clipboard.writeText(window.location.href).then(()=>{B(R(`link_copied`,n))})},[d,n]),me=(0,q.useCallback)(async()=>{if(!e)return;P(``);let t=O.trim();if(t.length<3){P(R(`comment_too_short`,n));return}if(t.length>5e3){P(R(`comment_too_long`,n));return}try{let r=await U.postComment(e,t,n);if(r.success){j(``),B(R(`comment_posted`,n));let t=await U.getArticle(e,n);t.success&&t.article&&p(t.article)}else P(r.error||R(`failed_to_post_comment`,n))}catch{P(R(`server_error`,n))}},[e,O,n]),he=(0,q.useCallback)(async(t,r)=>{try{let i=await U.voteComment(t,r);i.success?(K(n=>{let i={...n};return i[t]===r?delete i[t]:i[t]=r,localStorage.setItem(`votes-${e}`,JSON.stringify(i)),i}),p(e=>{if(!e)return null;let n=e.comments?.map(e=>e.id===t?{...e,upvotes:i.upvotes,downvotes:i.downvotes}:e);return{...e,comments:n}}),B(R(`vote_recorded`,n))):B(i.error||R(`failed_to_vote`,n),`error`)}catch{B(R(`server_error`,n),`error`)}},[e,n]),ge=(0,q.useCallback)(t=>{te(t),localStorage.setItem(`sort-${e}`,t)},[e]),_e=(0,q.useCallback)(e=>{re(t=>t===e?null:e),ne(t=>({...t,[e]:``}))},[]),ve=(0,q.useCallback)(async t=>{if(!e)return;let r=X[t]?.trim();if(!r||r.length<3){B(R(`reply_too_short`,n),`error`);return}try{let i=await U.postReply(t,r,n);if(i.success){ne(e=>({...e,[t]:``})),re(null),B(R(`reply_posted`,n));let r=await U.getArticle(e,n);r.success&&r.article&&p(r.article)}else B(i.error||R(`failed_to_post_reply`,n),`error`)}catch{B(R(`server_error`,n),`error`)}},[e,X,n]),ye=(0,q.useCallback)(async t=>{if(!(!ue||!window.confirm(R(`confirm_delete_comment`,n))))try{let r=await V.deleteComment(t);if(r.success){if(B(R(`comment_deleted`,n)),!e)return;let t=await U.getArticle(e,n);t.success&&t.article&&p(t.article)}else B(r.error||R(`failed_to_delete_comment`,n),`error`)}catch{B(R(`server_error`,n),`error`)}},[e,ue,n]),be=(0,q.useCallback)(async e=>{ae(!0),se(!0),ce(null);try{let t=await U.getUserProfile({userName:e});t.success&&t.profile?ce(t.profile):B(t.error||R(`failed_to_fetch_profile`,n),`error`)}catch{B(R(`server_error`,n),`error`)}finally{se(!1)}},[n]),xe=(0,q.useCallback)(()=>{ae(!1),ce(null)},[]),Se=(0,q.useCallback)(e=>{j(t=>{let n=`> "${e}"\n\n`;return t?`${t}\n${n}`:n});let t=document.getElementById(`comment-input`);t&&(t.scrollIntoView({behavior:`smooth`,block:`center`}),t.focus())},[]),Ce=(0,q.useRef)(null),we=(0,q.useCallback)(async t=>{if(t.preventDefault(),!e)return;let r=new FormData(t.currentTarget);try{let e=await U.submitDocument(r);e.success?(B(R(`submission_success`,n)),Ce.current?.reset()):B(e.error||R(`submission_failed`,n),`error`)}catch{B(R(`server_error`,n),`error`)}},[e,n]);if(g)return(0,J.jsx)(`div`,{className:`text-center py-8`,children:(0,J.jsx)(l,{className:`w-10 h-10 animate-spin text-bbcRed`})});if(!d)return(0,J.jsx)(`div`,{className:`text-center py-8 text-danger`,children:R(`article_not_found`,n)});let Te=y.includes(d.id),Ee=H(d.image)||`https://placehold.co/600x400/1a1a1a/FFF?text=BreachTimes`,De=Ee.startsWith(`http`)?Ee:`${window.location.origin}${Ee}`,Oe=window.location.href;return(0,J.jsxs)(`div`,{className:`max-w-[1280px] mx-auto px-2 sm:px-3`,children:[(0,J.jsxs)(t,{children:[(0,J.jsx)(`title`,{children:d.meta_title||d.title}),(0,J.jsx)(`meta`,{name:`description`,content:d.meta_description||d.summary}),(0,J.jsx)(`meta`,{name:`keywords`,content:d.meta_keywords||``}),(0,J.jsx)(`link`,{rel:`canonical`,href:Oe}),(0,J.jsx)(`meta`,{property:`og:title`,content:d.meta_title||d.title}),(0,J.jsx)(`meta`,{property:`og:description`,content:d.meta_description||d.summary}),(0,J.jsx)(`meta`,{property:`og:image`,content:De}),(0,J.jsx)(`meta`,{property:`og:url`,content:Oe}),(0,J.jsx)(`meta`,{property:`og:type`,content:`article`})]}),(0,J.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 lg:gap-12`,children:[(0,J.jsx)(`div`,{className:`lg:col-span-8`,children:(0,J.jsxs)(`article`,{className:`bg-card p-3 sm:p-4 md:p-5 rounded-2xl shadow-soft border border-border-color`,children:[(0,J.jsxs)(`div`,{className:`mb-4 sm:mb-6`,children:[(0,J.jsx)(`span`,{className:`bg-bbcRed text-white text-xs font-bold px-3 py-1 rounded-full mb-3 inline-block`,children:d.category}),(0,J.jsx)(`h1`,{className:`text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold leading-tight mb-3 sm:mb-4 text-card-text`,children:d.title}),(0,J.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2 sm:gap-4 text-xs sm:text-sm text-muted-text font-medium`,children:[(0,J.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,J.jsx)(k,{className:`w-4 h-4`}),` `,L(d.published_at,n)]}),d.readTime&&(0,J.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,J.jsx)(x,{className:`w-4 h-4`}),` `,d.readTime]})]})]}),(0,J.jsx)(`div`,{className:`mb-10 relative aspect-video bg-muted-bg rounded-2xl overflow-hidden shadow-lg`,children:(0,J.jsx)(`img`,{src:H(d.image)||`https://placehold.co/600x400/1a1a1a/FFF?text=BreachTimes`,alt:d.title,crossOrigin:`anonymous`,className:`w-full h-full object-cover`})}),(0,J.jsxs)(`div`,{className:`flex flex-col sm:flex-row items-center justify-between border-y border-border-color py-3 sm:py-4 mb-6 sm:mb-8 gap-3 sm:gap-0`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-1 bg-muted-bg rounded-lg p-1`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:()=>de(`sm`),className:`w-7 sm:w-8 h-7 sm:h-8 flex items-center justify-center hover:bg-card rounded transition-colors text-xs font-bold text-card-text ${C===`sm`?`bg-card`:``}`,children:`A`}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>de(`md`),className:`w-7 sm:w-8 h-7 sm:h-8 flex items-center justify-center hover:bg-card rounded transition-colors text-xs sm:text-sm font-bold text-card-text ${C===`md`?`bg-card`:``}`,children:`A`}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>de(`lg`),className:`w-7 sm:w-8 h-7 sm:h-8 flex items-center justify-center hover:bg-card rounded transition-colors text-sm sm:text-base font-bold text-card-text ${C===`lg`?`bg-card`:``}`,children:`A`})]}),(0,J.jsxs)(`div`,{className:`flex gap-2 sm:gap-3 w-full sm:w-auto`,children:[(0,J.jsxs)(`button`,{type:`button`,"aria-label":`Share article`,onClick:pe,className:`flex items-center justify-center gap-2 px-3 sm:px-4 py-2 rounded-full bg-muted-bg hover:bg-bbcRed hover:text-white transition-all text-xs sm:text-sm font-bold text-card-text flex-1 sm:flex-none`,children:[(0,J.jsx)(M,{className:`w-4 h-4`}),` `,R(`share`,n)]}),(0,J.jsx)(`button`,{type:`button`,"aria-label":`Toggle bookmark`,onClick:fe,className:`p-2.5 rounded-full bg-muted-bg hover:bg-bbcRed hover:text-white text-card-text transition-all shadow-sm flex items-center justify-center group`,children:(0,J.jsx)(v,{className:`w-5 h-5`,fill:Te?`currentColor`:`none`})})]})]}),(0,J.jsx)(`div`,{className:`relative`,children:(0,J.jsx)(ie,{content:d.content,className:`[&_p]:leading-[1.8] [&_p]:mb-[1em] space-y-6 sm:space-y-8 text-card-text transition-all duration-300`,fontSizeClass:C===`sm`?`[&_*:not(button):not(img):not(video):not(audio)]:text-[0.95rem] [&_p]:leading-[1.6]`:C===`lg`?`[&_*:not(button):not(img):not(video):not(audio)]:text-[1.35rem] [&_p]:leading-loose`:`[&_*:not(button):not(img):not(video):not(audio)]:text-base sm:[&_*:not(button):not(img):not(video):not(audio)]:text-lg [&_p]:leading-[1.8]`,containerRef:le,enableTextSelectionToolbar:!0,onAddComment:Se})})]})}),(0,J.jsxs)(`div`,{className:`lg:col-span-4 w-full`,children:[(0,J.jsxs)(`div`,{className:`w-full space-y-4 sm:space-y-6 lg:sticky lg:top-28`,children:[d.leaked_documents&&d.leaked_documents.length>0&&(0,J.jsxs)(`div`,{className:`bg-card p-4 sm:p-6 rounded-2xl shadow-soft border border-border-color`,children:[(0,J.jsxs)(`h4`,{className:`text-base sm:text-lg font-bold mb-3 sm:mb-4 text-card-text border-b border-border-color pb-2 flex items-center gap-2`,children:[(0,J.jsx)(u,{className:`w-5 h-5 text-bbcRed`}),R(`leaked_documents`,n)]}),(0,J.jsx)(`ul`,{className:`space-y-3`,children:d.leaked_documents.map(e=>(0,J.jsxs)(`li`,{className:`group flex items-center gap-3 p-2 rounded-lg hover:bg-muted-bg transition-colors cursor-pointer`,children:[(0,J.jsx)(`div`,{className:`w-10 h-10 rounded-lg bg-danger/10 dark:bg-danger/20 flex items-center justify-center flex-shrink-0 text-bbcRed font-bold text-xs border border-bbcRed/20`,children:e.file_type||`DOC`}),(0,J.jsxs)(`div`,{className:`flex-grow min-w-0`,children:[(0,J.jsx)(`p`,{className:`text-sm font-bold text-card-text truncate group-hover:text-bbcRed transition-colors`,children:e.display_name_bn||e.display_name_en}),(0,J.jsx)(`span`,{className:`text-[10px] text-muted-text uppercase tracking-wider`,children:`Download`})]}),(0,J.jsx)(`a`,{href:e.download_url||`/downloads/?file=${e.file_path}`,download:!0,target:`_blank`,rel:`noopener noreferrer`,className:`p-2 rounded-lg bg-bbcRed/10 text-bbcRed group-hover:bg-bbcRed group-hover:text-white transition-all`,children:(0,J.jsx)(c,{className:`w-4 h-4`})})]},e.id||e.display_name_en))})]}),d.documents&&d.documents.length>0&&(0,J.jsxs)(`div`,{className:`bg-card p-4 sm:p-6 rounded-2xl shadow-soft border border-border-color`,children:[(0,J.jsxs)(`h4`,{className:`text-base sm:text-lg font-bold mb-3 sm:mb-4 text-card-text border-b border-border-color pb-2 flex items-center gap-2`,children:[(0,J.jsx)(c,{className:`w-5 h-5 text-bbcRed`}),R(`downloadable_documents`,n)]}),(0,J.jsx)(`ul`,{className:`space-y-3`,children:d.documents.map(e=>(0,J.jsxs)(`li`,{className:`group flex items-center gap-3 p-3 rounded-lg hover:bg-muted-bg transition-colors cursor-pointer border border-transparent hover:border-bbcRed/30`,children:[(0,J.jsx)(`div`,{className:`w-10 h-10 rounded-lg bg-muted-bg dark:bg-muted-bg flex items-center justify-center flex-shrink-0 text-card-text dark:text-card-text font-bold text-xs border border-border-color/50`,children:e.file_type}),(0,J.jsxs)(`div`,{className:`flex-grow min-w-0`,children:[(0,J.jsx)(`p`,{className:`text-sm font-bold text-card-text truncate group-hover:text-bbcRed transition-colors`,title:e.display_name_bn||e.display_name_en,children:n===`bn`?e.display_name_bn||e.display_name_en:e.display_name_en||e.display_name_bn}),e.file_size&&(0,J.jsxs)(`span`,{className:`text-[10px] text-muted-text uppercase tracking-wider`,children:[Math.round(e.file_size/1024),` KB`]})]}),(0,J.jsx)(`a`,{href:e.download_url||`/downloads/?file=${encodeURIComponent(e.file_path)}`,download:!0,target:`_blank`,rel:`noopener noreferrer`,className:`p-2 rounded-lg bg-bbcRed/10 text-bbcRed group-hover:bg-bbcRed group-hover:text-white transition-all`,children:(0,J.jsx)(c,{className:`w-4 h-4`})})]},e.id))})]}),(0,J.jsx)(`div`,{className:`bg-card p-4 sm:p-6 rounded-2xl shadow-soft border border-border-color`,children:o?d.allow_submissions?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(`h4`,{className:`text-base sm:text-lg font-bold mb-3 sm:mb-4 text-card-text border-b border-border-color pb-2 flex items-center gap-2`,children:[(0,J.jsx)(A,{className:`w-5 h-5 text-bbcRed`}),R(`submit_documents`,n)]}),(0,J.jsxs)(`form`,{ref:Ce,onSubmit:we,className:`space-y-4`,children:[(0,J.jsx)(`input`,{type:`hidden`,name:`article_id`,value:d.id}),(0,J.jsxs)(`div`,{children:[(0,J.jsx)(`label`,{htmlFor:`document-input`,className:`block text-xs font-bold mb-2 text-muted-text`,children:R(`your_file`,n)}),(0,J.jsx)(`input`,{id:`document-input`,type:`file`,name:`document`,required:!0,className:`w-full text-xs text-card-text file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-bbcRed/10 file:text-bbcRed hover:file:bg-bbcRed/20`})]}),(0,J.jsxs)(`div`,{children:[(0,J.jsx)(`label`,{htmlFor:`message-textarea`,className:`block text-xs font-bold mb-2 text-muted-text`,children:R(`message_optional`,n)}),(0,J.jsx)(`textarea`,{id:`message-textarea`,name:`message`,rows:3,className:`w-full p-3 rounded-lg border border-border-color bg-muted-bg text-card-text text-sm focus:border-bbcRed outline-none`,placeholder:R(`write_details`,n)})]}),(0,J.jsx)(`button`,{type:`submit`,className:`w-full bg-bbcRed text-white py-2 rounded-lg font-bold text-sm hover:opacity-90 transition-opacity`,children:R(`submit`,n)})]})]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(`h4`,{className:`text-lg font-bold mb-2 text-card-text flex items-center gap-2`,children:[(0,J.jsx)(f,{className:`w-5 h-5 text-muted-text`}),R(`submissions_closed`,n)]}),(0,J.jsx)(`p`,{className:`text-sm text-muted-text font-bold text-danger`,children:R(`submissions_turned_off_by_admin`,n)})]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(`h4`,{className:`text-lg font-bold mb-2 text-card-text flex items-center gap-2`,children:[(0,J.jsx)(f,{className:`w-5 h-5 text-muted-text`}),n===`bn`?`à¦«à¦¾à¦‡à¦² à¦œà¦®à¦¾ à¦¦à¦¿à¦¤à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨`:`Sign in to submit`]}),(0,J.jsx)(`p`,{className:`text-sm text-muted-text mb-4`,children:n===`bn`?`à¦¨à¦¥à¦¿ à¦œà¦®à¦¾ à¦¦à¦¿à¦¤à§‡ à¦¦à¦¯à¦¼à¦¾ à¦•à¦°à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨`:`Please sign in to submit documents`}),(0,J.jsx)(r,{to:`/login`,className:`inline-block bg-bbcRed text-white px-6 py-2 rounded-full font-bold hover:bg-opacity-90 transition-all`,children:R(`sign_in`,n)})]})}),(0,J.jsxs)(`div`,{className:`bg-card p-4 sm:p-6 rounded-2xl shadow-soft border border-border-color`,children:[(0,J.jsx)(`h4`,{className:`text-base sm:text-lg font-bold mb-3 sm:mb-4 text-card-text`,children:R(`article_info`,n)}),(0,J.jsxs)(`div`,{className:`space-y-2 sm:space-y-3 text-xs sm:text-sm`,children:[(0,J.jsxs)(`div`,{className:`flex justify-between items-center pb-2 sm:pb-3 border-b border-border-color`,children:[(0,J.jsx)(`span`,{className:`text-muted-text`,children:R(`category`,n)}),(0,J.jsx)(`span`,{className:`font-bold text-card-text`,children:d.category})]}),(0,J.jsxs)(`div`,{className:`flex justify-between items-center pb-2 sm:pb-3 border-b border-border-color`,children:[(0,J.jsx)(`span`,{className:`text-muted-text`,children:R(`published`,n)}),(0,J.jsx)(`span`,{className:`font-bold text-card-text`,children:L(d.published_at,n)})]}),d.readTime&&(0,J.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,J.jsx)(`span`,{className:`text-muted-text`,children:R(`read_time`,n)}),(0,J.jsx)(`span`,{className:`font-bold text-card-text`,children:d.readTime})]})]})]})]}),d&&m.length>0&&(0,J.jsx)(z,{currentArticle:d,allArticles:m})]}),(0,J.jsxs)(`div`,{className:`lg:col-span-8 bg-card p-4 sm:p-6 md:p-8 rounded-2xl shadow-soft border border-border-color`,children:[(0,J.jsxs)(`div`,{className:`flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-3`,children:[(0,J.jsxs)(`h3`,{className:`text-xl sm:text-2xl font-bold text-card-text flex items-center gap-2`,children:[(0,J.jsx)(T,{className:`w-5 sm:w-6 h-5 sm:h-6 text-bbcRed`}),` `,R(`comments`,n)]}),(0,J.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,J.jsx)(`label`,{htmlFor:`sort-comments`,className:`text-xs font-bold text-muted-text`,children:R(`sort_by`,n)}),(0,J.jsx)(I,{id:`sort-comments`,value:Y,onChange:ge,options:[{value:`newest`,label:R(`newest`,n)},{value:`oldest`,label:R(`oldest`,n)},{value:`helpful`,label:R(`most_helpful`,n)},{value:`discussed`,label:R(`most_discussed`,n)}],className:`w-32`})]})]}),(0,J.jsx)(`div`,{className:`bg-card rounded-xl border border-border-color overflow-hidden`,children:d.comments&&d.comments.length>0?(0,J.jsx)(`div`,{className:`divide-y divide-border-color`,children:[...d.comments].sort((e,t)=>{if(Y===`newest`)return new Date(t.created_at).getTime()-new Date(e.created_at).getTime();if(Y===`oldest`)return new Date(e.created_at).getTime()-new Date(t.created_at).getTime();if(Y===`helpful`)return t.upvotes-t.downvotes-(e.upvotes-e.downvotes);if(Y===`discussed`){let n=e.replies?.length||0;return(t.replies?.length||0)-n}return 0}).map(e=>(0,J.jsxs)(`div`,{className:`p-4`,children:[(0,J.jsxs)(`div`,{className:`flex items-start gap-3 mb-2`,children:[(0,J.jsx)(`div`,{className:`w-10 h-10 rounded-full bg-gradient-to-br from-bbcRed to-orange-500 flex items-center justify-center font-bold text-white text-sm shadow-md flex-shrink-0`,children:e.user[0].toUpperCase()}),(0,J.jsxs)(`div`,{className:`flex-grow min-w-0`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:()=>be(e.user),className:`font-bold text-sm text-card-text block hover:text-bbcRed cursor-pointer transition-colors bg-transparent border-none p-0`,children:e.user}),(0,J.jsx)(`span`,{className:`text-xs text-muted-text`,children:e.time})]})]}),(0,J.jsx)(`p`,{className:`text-sm text-card-text ml-12 leading-relaxed mb-3`,children:(()=>{let t=s.sanitize(e.text),n=document.createElement(`div`);n.innerHTML=t;let r=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){let t=e,n={};for(let e=0;e<t.attributes.length;e++){let r=t.attributes[e],i=r.name===`class`?`className`:r.name;n[i]=r.value}let i=Array.from(t.childNodes).map(r);return(0,q.createElement)(t.tagName.toLowerCase(),n,...i)}return null};return Array.from(n.childNodes).map((e,t)=>r(e))})()}),(0,J.jsxs)(`div`,{className:`ml-12 flex items-center gap-3 text-xs`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:()=>he(e.id,`upvote`),className:`p-1 hover:text-success transition-colors text-muted-text vote-btn-up flex items-center justify-center min-w-[36px] min-h-[36px] ${G[e.id]===`upvote`?`text-success font-bold`:``}`,title:`Upvote`,children:(0,J.jsx)(D,{className:`w-3 h-3`})}),(0,J.jsx)(`span`,{className:`text-xs font-bold text-muted-text min-w-[20px] text-center`,children:e.upvotes-e.downvotes}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>he(e.id,`downvote`),className:`p-1 hover:text-danger transition-colors text-muted-text vote-btn-down flex items-center justify-center min-w-[36px] min-h-[36px] ${G[e.id]===`downvote`?`text-danger font-bold`:``}`,title:`Downvote`,children:(0,J.jsx)(b,{className:`w-3 h-3`})})]}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>_e(e.id),className:`px-3 py-1 hover:bg-bbcRed/10 dark:hover:bg-bbcRed/20 text-bbcRed rounded transition-colors font-bold text-sm`,children:R(`reply`,n)}),ue&&(0,J.jsx)(`button`,{type:`button`,onClick:()=>ye(e.id),className:`text-danger hover:text-danger/80 p-1 rounded hover:bg-danger/10 dark:hover:bg-danger/20`,children:(0,J.jsx)(_,{className:`w-3 h-3`})})]}),e.replies&&e.replies.length>0&&(0,J.jsx)(`div`,{className:`ml-12 mt-4 space-y-3 border-l-2 border-border-color pl-4`,children:e.replies.map(e=>(0,J.jsxs)(`div`,{children:[(0,J.jsxs)(`div`,{className:`flex items-start gap-2 mb-1`,children:[(0,J.jsx)(`div`,{className:`w-7 h-7 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center font-bold text-white text-xs shadow-md flex-shrink-0`,children:e.user[0].toUpperCase()}),(0,J.jsxs)(`div`,{className:`flex-grow min-w-0`,children:[(0,J.jsx)(`span`,{className:`font-bold text-xs text-card-text block`,children:e.user}),(0,J.jsx)(`span`,{className:`text-xs text-muted-text`,children:e.time})]})]}),(0,J.jsx)(`p`,{className:`text-xs text-card-text ml-9 leading-relaxed`,children:(()=>{let t=s.sanitize(e.text),n=document.createElement(`div`);n.innerHTML=t;let r=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){let t=e,n={};for(let e=0;e<t.attributes.length;e++){let r=t.attributes[e],i=r.name===`class`?`className`:r.name;n[i]=r.value}let i=Array.from(t.childNodes).map(r);return(0,q.createElement)(t.tagName.toLowerCase(),n,...i)}return null};return Array.from(n.childNodes).map((e,t)=>r(e))})()})]},e.id))}),Z===e.id&&(0,J.jsxs)(`div`,{className:`ml-12 mt-4 p-4 rounded-lg`,children:[(0,J.jsx)(`h4`,{className:`text-xs font-bold text-card-text mb-3`,children:R(`write_your_reply`,n)}),(0,J.jsx)(`textarea`,{value:X[e.id]||``,onChange:t=>ne(n=>({...n,[e.id]:t.target.value})),placeholder:R(`write_your_reply`,n),className:`w-full p-3 rounded-lg bg-card border border-border-color text-card-text focus:ring-2 focus:ring-bbcRed/30 focus:border-bbcRed outline-none transition-all resize-none text-sm mb-3 min-h-[80px]`}),(0,J.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[(0,J.jsx)(`button`,{type:`button`,onClick:()=>_e(e.id),className:`px-4 py-2 rounded-lg bg-card border border-border-color hover:bg-border-color transition-colors text-sm font-bold text-card-text`,children:R(`cancel`,n)}),(0,J.jsx)(`button`,{type:`button`,onClick:()=>ve(e.id),className:`px-4 py-2 rounded-lg bg-bbcRed hover:bg-bbcRed-hover text-white transition-colors text-sm font-bold shadow-soft hover:shadow-soft-hover`,children:R(`send_reply`,n)})]})]})]},e.id))}):(0,J.jsx)(`div`,{className:`text-center py-8 text-muted-text`,children:R(`no_comments_yet`,n)})}),(0,J.jsx)(`div`,{className:`border-t border-border-color pt-6`,children:o?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(`h4`,{className:`font-bold text-sm text-card-text mb-4`,children:R(`write_your_comment`,n)}),(0,J.jsx)(`textarea`,{id:`comment-input`,className:`w-full p-4 rounded-xl border border-border-color bg-card text-card-text focus:ring-2 focus:ring-bbcRed/20 focus:border-bbcRed outline-none transition-all resize-y text-base min-h-[150px]`,placeholder:R(`write_your_comment`,n),value:O,onChange:e=>j(e.target.value)}),(0,J.jsxs)(`div`,{className:`flex justify-between items-center mt-3 gap-4`,children:[(0,J.jsxs)(`div`,{className:`text-xs text-muted-text`,children:[O.length,`/5000`]}),N&&(0,J.jsx)(`div`,{className:`text-xs text-danger font-bold`,children:N}),(0,J.jsx)(`button`,{type:`button`,onClick:me,className:`bg-bbcRed text-white px-6 py-2.5 rounded-full font-bold hover:bg-opacity-90 hover:shadow-lg hover:-translate-y-0.5 transition-all text-sm`,children:R(`post_comment`,n)})]})]}):(0,J.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-8 text-center`,children:[(0,J.jsx)(f,{className:`w-12 h-12 text-muted-text mb-3`}),(0,J.jsx)(`p`,{className:`text-card-text font-bold mb-3`,children:n===`bn`?`à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦•à¦°à¦¤à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨`:`Sign in to comment`}),(0,J.jsx)(r,{to:`/login`,className:`bg-bbcRed text-white px-6 py-2 rounded-full font-bold hover:bg-opacity-90 transition-all`,children:R(`sign_in`,n)})]})})]})]}),Q&&(0,J.jsx)(`button`,{type:`button`,onClick:xe,onKeyDown:e=>{e.key===`Escape`&&xe()},className:`fixed inset-0 bg-black/50 dark:bg-black/70 z-[200] flex items-center justify-center p-4 border-none`,children:(0,J.jsxs)(`div`,{role:`dialog`,"aria-modal":`true`,"aria-labelledby":`profile-modal-title`,className:`bg-card rounded-2xl shadow-2xl border border-border-color max-w-md w-full max-h-[90vh] overflow-y-auto`,onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:[(0,J.jsxs)(`div`,{className:`sticky top-0 bg-card border-b border-border-color p-4 flex items-center justify-between`,children:[(0,J.jsxs)(`h3`,{className:`text-xl font-bold text-card-text`,children:[`ðŸ‘¤ `,R(`user_profile`,n)]}),(0,J.jsx)(`button`,{type:`button`,onClick:xe,className:`p-2 hover:bg-muted-bg rounded-lg transition-colors`,children:(0,J.jsx)(E,{className:`w-5 h-5`})})]}),(0,J.jsx)(`div`,{id:`profile-content`,className:`p-6 space-y-4`,children:oe?(0,J.jsx)(`div`,{className:`flex items-center justify-center py-8`,children:(0,J.jsx)(l,{className:`w-6 h-6 animate-spin text-bbcRed`})}):$?(0,J.jsxs)(`div`,{className:`space-y-4`,children:[(0,J.jsxs)(`div`,{className:`flex items-center gap-4 pb-4 border-b border-border-color`,children:[(0,J.jsx)(`div`,{className:`w-16 h-16 rounded-full bg-gradient-to-br from-bbcRed to-orange-500 flex items-center justify-center font-bold text-white text-2xl shadow-lg`,children:$.displayName[0].toUpperCase()}),(0,J.jsxs)(`div`,{children:[(0,J.jsx)(`h4`,{className:`text-lg font-bold text-card-text`,children:$.displayName}),(0,J.jsx)(`p`,{className:`text-xs text-muted-text`,children:$.email})]})]}),(0,J.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,J.jsxs)(`div`,{className:`bg-muted-bg p-3 rounded-lg border border-border-color`,children:[(0,J.jsx)(`div`,{className:`text-2xl font-bold text-bbcRed`,children:$.commentCount}),(0,J.jsx)(`div`,{className:`text-xs text-muted-text`,children:R(`comments_count`,n)})]}),(0,J.jsxs)(`div`,{className:`bg-muted-bg p-3 rounded-lg border border-border-color`,children:[(0,J.jsx)(`div`,{className:`text-2xl font-bold text-success`,children:$.upvotes}),(0,J.jsx)(`div`,{className:`text-xs text-muted-text`,children:R(`received_likes`,n)})]})]}),$.recentComments&&$.recentComments.length>0&&(0,J.jsxs)(`div`,{children:[(0,J.jsx)(`div`,{className:`text-sm font-bold text-card-text mb-2`,children:R(`recent_comments`,n)}),(0,J.jsx)(`div`,{className:`space-y-2`,children:$.recentComments.map(e=>(0,J.jsxs)(`div`,{className:`bg-muted-bg p-2 rounded-lg text-xs text-card-text border border-border-color`,children:[(0,J.jsxs)(`p`,{className:`mb-1`,children:[`"`,e.text,`"`]}),(0,J.jsxs)(`div`,{className:`flex items-center justify-between text-muted-text text-xs`,children:[(0,J.jsx)(`span`,{children:e.time}),(0,J.jsxs)(`span`,{children:[(0,J.jsx)(D,{className:`w-3 h-3 inline-block mr-1`}),` `,e.upvotes]})]})]},`comment-${e.text.substring(0,20)}`))})]})]}):(0,J.jsx)(`div`,{className:`text-center py-8`,children:(0,J.jsx)(`p`,{className:`text-muted-text`,children:R(`user_profile_not_found`,n)})})})]})})]})};export{$ as default};